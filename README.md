# Lisp Machine

**Lisp Machine** - –ø—Ä–æ–µ–∫—Ç, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –∏–∑ —Å–µ–±—è —Å—Ä–µ–¥—É –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è (Runtime), –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â—É—é –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, —Ç–∞–∫ –∏ –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –º–∞–∫—Ä–æ—Å—ã, –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π Java (Interop).

---

## üìã –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¢–ó "Lisp-–º–∞—à–∏–Ω–∞". –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä**.

### –ë–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- [x] **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏** (`lambda`, –∑–∞–º—ã–∫–∞–Ω–∏—è)
- [x] **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–µ–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** (`let`)
- [x] **–†–µ–∫—É—Ä—Å–∏—è** (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ —Å–∞–º–æ–π —Å–µ–±—è)
- [x] **–î–æ—Å—Ç—É–ø –∫ –≤—ã–∑–æ–≤–∞–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã** (–≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤ Java —á–µ—Ä–µ–∑ Reflection API)
- [x] **–í–µ—Ç–≤–ª–µ–Ω–∏–µ –∏ –ª–æ–≥–∏–∫–∞** (`if`, –ª–µ–Ω–∏–≤—ã–µ `and`, `or`)
- [x] **–¶–∏–∫–ª—ã** (`while`)
- [x] **–ò–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ** (`set!`, –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ)
- [x] **–ú–∞–∫—Ä–æ—Å—ã** (`defmacro`, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è AST –¥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è)
- [x] **–í–≤–æ–¥-–≤—ã–≤–æ–¥** (`print`, `read`)

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- [x] **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π** (`try`, `catch`, `throw` —Å –ø—Ä–æ–±—Ä–æ—Å–æ–º Java-–∏—Å–∫–ª—é—á–µ–Ω–∏–π)
- [x] **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ª–µ–∫—Å–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã** (`binding` —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∑–Ω–∞—á–µ–Ω–∏—è)
- [x] **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã** (–ú–∞–∫—Ä–æ—Å—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –æ–±—ä–µ–∫—Ç—ã –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è JVM/AST, –∞ –Ω–µ —Ç–µ–∫—Å—Ç)

---

## üöÄ –ó–∞–ø—É—Å–∫ –∏ –°–±–æ—Ä–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
*   Java 17 –∏–ª–∏ –≤—ã—à–µ
*   Maven 3.6+

### –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
```bash
mvn clean package
```

### –ó–∞–ø—É—Å–∫ REPL (–ö–æ–Ω—Å–æ–ª—å)
–ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π jar-—Ñ–∞–π–ª –ø–æ—è–≤–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ `target`.
```bash
java -jar target/lispmachine-1.0-SNAPSHOT.jar
```

–î–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞:
```lisp
(exit)
```

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### 1. –§–∞–∫—Ç–æ—Ä–∏–∞–ª (–†–µ–∫—É—Ä—Å–∏—è)
```lisp
(define fact 
    (lambda (n) 
        (if (< n 2) 
            1 
            (* n (fact (- n 1))))))

(print (fact 5)) 
;; –†–µ–∑—É–ª—å—Ç–∞—Ç: 120
```

### 2. –ú–∞–∫—Ä–æ—Å—ã (Meta-programming)
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ü–∏–∫–ª–∞ `for` —á–µ—Ä–µ–∑ –º–∞–∫—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ `while`:
```lisp
(defmacro for (var start end body)
  (list (quote let) (list (list var start))
        (list (quote while) (list (quote <) var end)
              body
              (list (quote set!) var (list (quote +) var 1))
        )
        (list (quote quote) (list))
  ))

(for i 0 5 (print i))
```

### 3. Java Interop (–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Java)
–í—ã–∑–æ–≤ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Java:
```lisp
;; –í—ã–∑–æ–≤ Math.max(10, 20)
(print (java-call "java.lang.Math" "max" 10 20)) 
;; –†–µ–∑—É–ª—å—Ç–∞—Ç: 20

;; –†–∞–±–æ—Ç–∞ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏
(print (java-call "java.lang.String" "valueOf" 12345))
```

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```lisp
(try 
    (throw "Something went wrong") 
    (catch e 
        (print "Caught error:" e)))
;; –í—ã–≤–æ–¥: Caught error: Something went wrong
```

### 5. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ (Binding)
```lisp
(define *config* "DEFAULT")

(define show-config 
    (lambda () (print *config*)))

(show-config) ;; -> DEFAULT

(binding ((*config* "DEBUG"))
    (show-config)) ;; -> DEBUG

(show-config) ;; -> DEFAULT
```

---

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

*   **Parser:** –†—É–∫–æ–ø–∏—Å–Ω—ã–π —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä –∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å–ø—É—Å–∫. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏, —á–∏—Å–ª–∞, —Å–∏–º–≤–æ–ª—ã –∏ —Å–ø–∏—Å–∫–∏.
*   **Runtime:**
    *   `Evaluator`: –í—ã—á–∏—Å–ª—è–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ø–µ—Ü—Ñ–æ—Ä–º—ã.
    *   `ExecutionContext`: –†–µ–∞–ª–∏–∑—É–µ—Ç –¥–µ—Ä–µ–≤–æ –æ–±–ª–∞—Å—Ç–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ (Scope).
    *   `LispValue`: –û–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (Cons, Symbol, Number, String, Function).
*   **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** JUnit 5.

---

